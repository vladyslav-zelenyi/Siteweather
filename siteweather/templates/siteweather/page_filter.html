{% extends 'base.html' %}

{% block title %}
    {{ title }}
{% endblock %}

{% block sidebar %}
    {% include 'inc/_sidebar.html' %}
{% endblock %}

{% block content %}
    {% if not query %}
        <form action="{% url 'page_filter' %}" method="post" autocomplete="off">
            {% csrf_token %}
            <div class="card mb-4">
                <div class="card-header">
                    <div class="form-group">
                        <label for="{{ form.city_name.id_for_label }}">
                            <h6>
                                City name:
                            </h6>
                        </label>
                        {{ form.city_name }}
                        <div class="invalid-feedback">
                            {{ form.city_name.errors }}
                        </div>
                    </div>

                    {{ form.non_field_errors }}
                    <button type="submit" class="btn-primary btn-block">
                        <h6>
                            Find
                        </h6>
                    </button>
                </div>
            </div>
        </form>
    {% else %}
        {% for item in query %}
            <div class="card mb-4">
                <div class="card-header">
                    <h5>
                        {{ item.city_name }} | {{ item.country }}
                    </h5>
                </div>
                <div class="card-body">
                    <div class="media">
                        <img src="https://openweathermap.org/img/w/{{ item.weather_icon }}.png"/>
                        <div class="media-body">
                            <h6 class="card-text">{{ item.temperature }}Â°C</h6>
                            <h5 class="card-text">{{ item.weather_main_description }}
                            </h5>
                            <a href="{{ item.get_absolute_url }}" class="btn btn-primary">Read more</a>
                        </div>
                    </div>
                </div>
                <div class="card-footer text-muted">
                    {{ item.timestamp|date:'Y-m-d | H:i:s' }}
                </div>
            </div>
        {% endfor %}
    {% endif %}
{% endblock %}

{% block pagantion %}
    {% include 'inc/_pagination.html' %}
{% endblock %}